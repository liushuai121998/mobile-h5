$define(["wgt_util","wgt_readyload","jquery.adFocus","jquery.mediaQuery"],function(e,d,s,t,r){var p=function(e,t){var r,a,o,s=t.defaultImage,i=t.definedDefaultImage;r=e,o=s,1==(a=i)||"true"==a?d(".p_images img",r).onErrorImg(o):d(".p_images img",r).onErrorImg();var n=2;if(t.isOpenCutMode&&(n=1),t.isRate){var m=t.widthOfRate/t.heightOfRate;d(".p_image",e).putPhotoDiv(n,m)}else d(".p_image",e).putPhotoDiv(n)};function c(p){var c=$compCl.getScope(p.id),e=p.requestParam.orderColumn||"def",t=!0;p.requestParam.orderType&&"0"==p.requestParam.orderType&&(t=!1);var r={key:e,downArraw:t},a={click:function(e,t,r,a){if("def"==r.key){t.attr("lang","active");var o=t.siblings();d.resetOtherSort(o,a),p.requestParam.orderColumn=r.key,p.requestParam.orderType="0"}else{d.triggerProductSort(t,r,a);var s=t.data("productCount");p.requestParam.orderColumn=r.key,p.requestParam.orderType=s}var i,n,m,l,u=(l=p.id,i="/comp/portalResProduct/list.do?compId="+l,n=p.requestParam,d.ajax({type:"POST",url:i,data:n,async:!1,success:function(e){m=e}}),m);c.html(u)}};return{item:[{show:!0,type:"sort",key:"def",v:p.sortParams.DEFAULT_SORT.v,title:p.sortParams.DEFAULT_SORT.title,downArraw:!0,action:a},{show:p.sortParams.PUBLISH_TIME.show,type:"sort",key:"PUBLISH_TIME",v:p.sortParams.PUBLISH_TIME.v,title:p.sortParams.PUBLISH_TIME.title,downArraw:!0,action:a},{show:p.sortParams.PRODUCT_NAME.show,type:"sort",key:"PRODUCT_NAME",v:p.sortParams.PRODUCT_NAME.v,title:p.sortParams.PRODUCT_NAME.title,downArraw:!1,action:a},{show:p.sortParams.PVS.show,type:"sort",key:"PVS",v:p.sortParams.PVS.v,title:p.sortParams.PVS.title,downArraw:!0,action:a},{show:p.sortParams.comment.show,type:"sort",key:"comment",v:p.sortParams.comment.v,title:p.sortParams.comment.title,downArraw:!0,action:a},{show:p.sortParams.PRODUCT_CODE.show,type:"sort",key:"PRODUCT_CODE",v:p.sortParams.PRODUCT_CODE.v,title:p.sortParams.PRODUCT_CODE.title,downArraw:!1,action:a}],elements:{def:{style:p.sortParams.DEFAULT_SORT.style,zstyle:"p_default",tstyle:""},PUBLISH_TIME:{style:p.sortParams.PUBLISH_TIME.style,zstyle:"p_TimeSort",tstyle:"i_TimeSort"},PRODUCT_NAME:{style:p.sortParams.PRODUCT_NAME.style,zstyle:"p_NameSort",tstyle:"i_NameSort"},PVS:{style:p.sortParams.PVS.style,zstyle:"p_ViewSort",tstyle:"i_ViewSort"},comment:{style:p.sortParams.comment.style,zstyle:"p_CommentSort",tstyle:"i_CommentSort"},PRODUCT_CODE:{style:p.sortParams.PRODUCT_CODE.style,zstyle:"p_NoSort",tstyle:"i_NoSort"}},defVal:r}}function P(e,t){var r,a;r=t,a=e.imageOpts,r.find(".p_imagesPc").each(function(e){var t=jQuery.extend(!0,{},a),r=d(this).attr("imgData");d(this).removeAttr("imgData"),r&&(t.data=JSON.parse(r),d(this).adFocus(t)),d(this).find(".p_linkB").attr("href",d(this).data("url"))})}function y(e,t){if(null!=(o=e)&&null!=o&&0!=o.length){var r=d(t).parent(".p_interaction").find(".js_compareFloatData"),a={image:r.attr("image"),name:r.attr("name"),id:r.attr("id"),templateId:r.attr("templateId")};$compCl.getAllInitFunc()[e].add(a),s.lazyImg()}else console.log("获取不到产品浮动框组件,compId="+e);var o}return{init:function(){var e=this._params,t=$compCl.getScope(e.id);t.find(".p_sort").createProductSort(c(e)).init();var r,a,o,s,i,n,m,l,u;e.requestParam.orderType||(e.requestParam.orderType="0"),e.requestParam.orderColumn||(e.requestParam.orderColumn="def"),isFrontEnv()&&d(window).resize(function(){console.log(d(document).width()),d.mediaQuery({callback1024:function(){console.log("1024以上执行")},callback7681024:function(){location.reload()},callback768:function(){console.log("768以下执行")},firstLoad:!1})}),768==d.mediaQuery({node:!0})?(d(".p_OccupyBox .p_page").hide(),0<d(".p_OccupyBox .p_pagebox").length?d(".p_OccupyBox .p_pagebox").show():("turnPage"==e.pageParam.turnPageType&&d(".p_products",t).removeAttr("isServerPaging"),s=t,(n={firstRefresh:!1}).url=(i=e).pageParam.url+"&orderType="+i.requestParam.orderType+"&orderColumn="+i.requestParam.orderColumn+"&"+i.requestParam.appType+"="+i.requestParam.productCateId,n.data=i.pageParam,n.successFun=function(e){console.log("123")},d(".p_products",s).resPaging(n))):7681024!=d.mediaQuery({node:!0})&&1024!=d.mediaQuery({node:!0})||(console.log("333333333"),P(e,t),d(".p_OccupyBox .p_pagebox").hide(),0<d(".p_OccupyBox .p_page").length&&d(".p_OccupyBox .p_page").show(),"turnPage"==e.pageParam.turnPageType&&d(".p_products",t).removeAttr("isServerPaging"),r=t,o={url:(a=e).pageParam.url+"&orderType="+a.requestParam.orderType+"&orderColumn="+a.requestParam.orderColumn+"&"+a.requestParam.appType+"="+a.requestParam.productCateId,appId:a.pageParam.appId,successFun:function(e){}},d(".p_products",r).resPaging(o)),p(t,e.picParams),(m=t).find(".p_addInquiry").unbind("click").click(function(){var e=d(".js-protalResProductEnquiry_floating_compId"),r=d(this);e.each(function(){var e=d(this).val(),t=d("#"+e);"none"==t.css("display")&&t.show(),y(e,r)})}),m.find(".p_btnB").unbind("click").click(function(){var e=d(".js-protalResProduct_floating_compId").val(),t=d("#"+e);"none"==t.css("display")&&t.show(),y(e,this)}),l=t,(u=e.textParams).isCutOfName&&d(".d_title",l).fixLineN(u.linesOfCutOfName),u.isCutOfSummary&&d(".d_summary",l).fixLineN(u.linesOfCutOfSummary),u.categorySummary&&d(".p_categorySummary",l).fixLineN(u.categorySummaryMaxLen)}}});